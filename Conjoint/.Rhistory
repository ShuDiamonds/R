#conjointパッケージのインストール
install.packages("conjoint")
library("conjoint")
#teaデータの読み込み
data(tea)
head(tea)
tea
tlecn
View(tlevn)
tlevn
head(tpref)
#因子の組み合わせを作成
experiment<-expand.grid(
+     price=c("low","medium","high"),
+     variety=c("black","green","red"),
+     kind=c("bags","granulated","leafy"),
+     aroma=c("yes","no"))
experiment<-expand.grid(
+price=c("low","medium","high"),
+variety=c("black","green","red"),
+kind=c("bags","granulated","leafy"),
+aroma=c("yes","no"))
experiment<-expand.grid(
price=c("low","medium","high"),
variety=c("black","green","red"),
kind=c("bags","granulated","leafy"),
aroma=c("yes","no"))
head(experiment)
design<-caFactorialDesign(data=experiment,type="orthogonal")
#因子の直交表を表示
print(design)
#因子の直交表をコード化
code<-caEncodedDesign(design)
#コード化された直交表の表示
print(code)
#相関係数の表示
print(cor(code))
print(tprof)
#各水準のラベル
print(tlevn)
#アンケートデータの表示
head(tprefm)
Conjoint(tprefm, tprof, tlevn)
print(tprof)
#各水準のラベル
print(tlevn)
head(tprefm)
print(tlevn)
print(tprof)
#各水準のラベル
print(tlevn)
head(tprefm)
View(tpref)
View(tpref)
View(tprefm)
View(tprefm)
caSegmentation(tprefm,tprof,5)
segments<-caSegmentation(tprefm,tprof,5)
load("C:/Users/FMV/Google Drive/software/R/project/DataScientistBook/.RData")
View(tsimp)
#参考ＵＲＬ: http://www.trifields.jp/research-conjoint-analysis-344
#conjointパッケージのインストール
install.packages("conjoint")
#conjointパッケージの読み込み
library("conjoint")
#teaデータの読み込み
data(tea)
#因子の組み合わせを作成
experiment<-expand.grid(
price=c("low","medium","high"),
variety=c("black","green","red"),
kind=c("bags","granulated","leafy"),
aroma=c("yes","no"))
#因子の直交表を作成
design<-caFactorialDesign(data=experiment,type="orthogonal")
#因子の直交表を表示
print(design)
#因子の直交表をコード化
code<-caEncodedDesign(design)
#コード化された直交表の表示
print(code)
#相関係数の表示
print(cor(code))
#商品プロファイル-アンケートに記載する13個の商品
print(tprof)
#各水準のラベル
print(tlevn)
#アンケートデータの表示
head(tprefm)
Conjoint(tprefm, tprof, tlevn)
#5つのクラスターに分類
segments<-caSegmentation(tprefm,tprof,5)
head(segments)
#アンケートデータの表示
head(tprefm)
newdata<-merge(tprefm,segments$cluster)
head(newdat)a
head(newdat)
head(newdate)
head(newdata)
head(newdata[,newdata$y==1])
head(newdata[newdata$y==1,])
hist(newdata[newdata$y==1,])
newdata2 <- prcomp(newdata[newdata$y==1,],scale=T)
#表示
biplot(state.pca)
head(newdata)
newdata2 <- prcomp(newdata[newdata$y==1,1:13],scale=T)
#表示
biplot(state.pca)
biplot(newdata2)
newdata2 <- prcomp(newdata[newdata$y==2,1:13],scale=T)
#表示
biplot(newdata2)
head(newdata)
hist(newdata[newdata$y==2,]$profil1)
hist(newdata[newdata$y==1,]$profil1)
hist(newdata[newdata$y==11,]$profil1)
hist(newdata[newdata$y==10,]$profil1)
hist(newdata[newdata$y==5,]$profil1)
#アンケートデータの表示
head(tprefm)
length(tprefm)
